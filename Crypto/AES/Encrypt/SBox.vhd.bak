LIBRARY ieee;
USE ieee.std_logic_1164.ALL;

ENTITY SBox IS
    PORT (
        input_byte : IN STD_LOGIC_VECTOR(7 DOWNTO 0);
        output_byte : OUT STD_LOGIC_VECTOR(7 DOWNTO 0)
    );
END ENTITY;

ARCHITECTURE rtl OF SBox IS
    TYPE SBoxArray IS ARRAY (x"00" TO x"ff") OF STD_LOGIC_VECTOR(7 DOWNTO 0);
    CONSTANT SBoxLUT : SBoxArray := (
        x"00" => x"63", x"01" => x"7c", x"02" => x"77", x"03" => x"7b",
        x"04" => x"f2", x"05" => x"6b", x"06" => x"6f", x"07" => x"c5",
        x"08" => x"30", x"09" => x"01", x"0a" => x"67", x"0b" => x"2b",
        x"0c" => x"fe", x"0d" => x"d7", x"0e" => x"ab", x"0f" => x"76",

        x"10" => x"ca", x"11" => x"82", x"12" => x"c9", x"13" => x"7d",
        x"14" => x"fa", x"15" => x"59", x"16" => x"47", x"17" => x"f0",
        x"18" => x"ad", x"19" => x"d4", x"1a" => x"a2", x"1b" => x"af",
        x"1c" => x"9c", x"1d" => x"a4", x"1e" => x"72", x"1f" => x"c0",

        x"20" => x"b7", x"21" => x"fd", x"22" => x"93", x"23" => x"26",
        x"24" => x"36", x"25" => x"3f", x"26" => x"f7", x"27" => x"cc",
        x"28" => x"34", x"29" => x"a5", x"2a" => x"e5", x"2b" => x"f1",
        x"2c" => x"71", x"2d" => x"d8", x"2e" => x"31", x"2f" => x"15",

        x"30" => x"04", x"31" => x"c7", x"32" => x"23", x"33" => x"c3",
        x"34" => x"18", x"35" => x"96", x"36" => x"05", x"37" => x"9a",
        x"38" => x"07", x"39" => x"12", x"3a" => x"80", x"3b" => x"e2",
        x"3c" => x"eb", x"3d" => x"27", x"3e" => x"b2", x"3f" => x"75",

        x"40" => x"09", x"41" => x"83", x"42" => x"2c", x"43" => x"1a",
        x"44" => x"1b", x"45" => x"6e", x"46" => x"5a", x"47" => x"a0",
        x"48" => x"52", x"49" => x"3b", x"4a" => x"d6", x"4b" => x"b3",
        x"4c" => x"29", x"4d" => x"e3", x"4e" => x"2f", x"4f" => x"84",

        x"50" => x"53", x"51" => x"d1", x"52" => x"00", x"53" => x"ed",
        x"54" => x"20", x"55" => x"fc", x"56" => x"b1", x"57" => x"5b",
        x"58" => x"6a", x"59" => x"cb", x"5a" => x"be", x"5b" => x"39",
        x"5c" => x"4a", x"5d" => x"4c", x"5e" => x"58", x"5f" => x"cf",

        x"60" => x"d0", x"61" => x"ef", x"62" => x"aa", x"63" => x"fb",
        x"64" => x"43", x"65" => x"4d", x"66" => x"33", x"67" => x"85",
        x"68" => x"45", x"69" => x"f9", x"6a" => x"02", x"6b" => x"7f",
        x"6c" => x"50", x"6d" => x"3c", x"6e" => x"9f", x"6f" => x"a8",

        x"70" => x"51", x"71" => x"a3", x"72" => x"40", x"73" => x"8f",
        x"74" => x"92", x"75" => x"9d", x"76" => x"38", x"77" => x"f5",
        x"78" => x"bc", x"79" => x"b6", x"7a" => x"da", x"7b" => x"21",
        x"7c" => x"10", x"7d" => x"ff", x"7e" => x"f3", x"7f" => x"d2",

        x"80" => x"cd", x"81" => x"0c", x"82" => x"13", x"83" => x"ec",
        x"84" => x"5f", x"85" => x"97", x"86" => x"44", x"87" => x"17",
        x"88" => x"c4", x"89" => x"a7", x"8a" => x"7e", x"8b" => x"3d",
        x"8c" => x"64", x"8d" => x"5d", x"8e" => x"19", x"8f" => x"73",

        x"90" => x"60", x"91" => x"81", x"92" => x"4f", x"93" => x"dc",
        x"94" => x"22", x"95" => x"2a", x"96" => x"90", x"97" => x"88",
        x"98" => x"46", x"99" => x"ee", x"9a" => x"b8", x"9b" => x"14",
        x"9c" => x"de", x"9d" => x"5e", x"9e" => x"0b", x"9f" => x"db",

        x"a0" => x"e0", x"a1" => x"32", x"a2" => x"3a", x"a3" => x"0a",
        x"a4" => x"49", x"a5" => x"06", x"a6" => x"24", x"a7" => x"5c",
        x"a8" => x"c2", x"a9" => x"d3", x"aa" => x"ac", x"ab" => x"62",
        x"ac" => x"91", x"ad" => x"95", x"ae" => x"e4", x"af" => x"79",

        x"b0" => x"e7", x"b1" => x"c8", x"b2" => x"37", x"b3" => x"6d",
        x"b4" => x"8d", x"b5" => x"d5", x"b6" => x"4e", x"b7" => x"a9",
        x"b8" => x"6c", x"b9" => x"56", x"ba" => x"f4", x"bb" => x"ea",
        x"bc" => x"65", x"bd" => x"7a", x"be" => x"ae", x"bf" => x"08",

        x"c0" => x"ba", x"c1" => x"78", x"c2" => x"25", x"c3" => x"2e",
        x"c4" => x"1c", x"c5" => x"a6", x"c6" => x"b4", x"c7" => x"c6",
        x"c8" => x"e8", x"c9" => x"dd", x"ca" => x"74", x"cb" => x"1f",
        x"cc" => x"4b", x"cd" => x"bd", x"ce" => x"8b", x"cf" => x"8a",

        x"d0" => x"70", x"d1" => x"3e", x"d2" => x"b5", x"d3" => x"66",
        x"d4" => x"48", x"d5" => x"03", x"d6" => x"f6", x"d7" => x"0e",
        x"d8" => x"61", x"d9" => x"35", x"da" => x"57", x"db" => x"b9",
        x"dc" => x"86", x"dd" => x"c1", x"de" => x"1d", x"df" => x"9e",

        x"e0" => x"e1", x"e1" => x"f8", x"e2" => x"98", x"e3" => x"11",
        x"e4" => x"69", x"e5" => x"d9", x"e6" => x"8e", x"e7" => x"94",
        x"e8" => x"9b", x"e9" => x"1e", x"ea" => x"87", x"eb" => x"e9",
        x"ec" => x"ce", x"ed" => x"55", x"ee" => x"28", x"ef" => x"df",

        x"f0" => x"8c", x"f1" => x"a1", x"f2" => x"89", x"f3" => x"0d",
        x"f4" => x"bf", x"f5" => x"e6", x"f6" => x"42", x"f7" => x"68",
        x"f8" => x"41", x"f9" => x"99", x"fa" => x"2d", x"fb" => x"0f",
        x"fc" => x"b0", x"fd" => x"54", x"fe" => x"bb", x"ff" => x"16"
    );
BEGIN
    processSBoxLUT : PROCESS (input_byte) IS
    begin
        output_byte <= SBoxLUT(input_byte);
    END PROCESS lut;
END ARCHITECTURE behavioral;